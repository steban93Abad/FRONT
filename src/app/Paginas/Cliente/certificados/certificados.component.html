<app-header></app-header>
<app-sidebar></app-sidebar>
<div class="content-wrapper">
  <div class="container-fluid">
      <h4 class="NombrePage">{{PaginaNombre}}</h4>
      <section class="content">
          <div class="container-fluid">
              <div class="card card-default">

                  <!-- BARRA PRINCIPAL -->
                <section class="horizontal-center" *ngIf="TituloFormulario == ''">
                  <div class="card-header" style="background-color: var(--color-formulario-primario)">
                    <div class="btn-group" role="group">
                      <button class="btnHome" (click)="ListarElementos(1)">
                        <i class="fa-solid fa-house"></i>
                      </button>
                    </div>
                    <div class="btn-group float-right" role="group">
                      <label type="text-info" class="formControl CenterItemColorSecundario center ml-1" style="width: 50%"
                        *ngIf="itemBusqueda.value !== ''">{{ itemBusqueda.value }}</label>

                      <button type="button" class="btnFilter ml-1" data-toggle="dropdown">
                        <i class="bi bi-funnel"></i>
                      </button>

                      <div class="OcultarMax450px" style="width: 50%">
                        <input *ngIf="
                            itemBusqueda.value !== ''
                          " id="txtValorBusqueda" [formControl]="txtBusqueda" (keydown.enter)="FiltrarElemento()"
                          (keyup)="ConvertirMayusculas()" class="form-control ml-2" type="text" placeholder="Buscar"
                          autofocus />
                      </div>

                      <div>
                        <button type="button" class="btnBuscar ml-2 OcultarMax450px" *ngIf="txtBusqueda.value !== ''"
                          (click)="FiltrarElemento()">
                          <i class="bi bi-search"></i>
                        </button>
                      </div>

                      <div class="dropdown-menu" role="menu">
                        <a class="dropdown-item" (click)="GetBusquedaPor(item)" *ngFor="let item of ParametrosDeBusqueda">{{
                          item }}</a>
                      </div>
                    </div>
                  </div>
                  <div class="card-header OcultarMin450px" style="background-color: var(--color-formulario-primario)">
                    <div class="btn-group float-right" role="group">
                      <input *ngIf="
                          itemBusqueda.value !== '' &&
                          (itemBusqueda.value === 'Descripción' ||
                            itemBusqueda.value === 'Descripción Incompleta')
                        " id="txtValorBusqueda" style="width: 80%" [formControl]="txtBusqueda"
                        (keyup)="ConvertirMayusculas()" class="form-control ml-2"
                        type="text" placeholder="Buscar" autofocus />

                      <select class="form-select" *ngIf="
                          itemBusqueda.value !== '' && itemBusqueda.value === 'Estado'
                        " [formControl]="txtBusqueda" [spellcheck]="false" style="width: 150px">
                        <option>

                        </option>
                      </select>

                      <button type="button" class="btnBuscar ml-2">
                        <i class="bi bi-search"></i>
                      </button>
                    </div>
                  </div>
                </section>


                <!-- FORMULARIO PARA LISTAR ELEMENTOS -->
                <section class="expand-bottom">
                    <div class="card-body" style="background-color: var(--color-formulario-secundario);"
                      *ngIf="!loading ;else loadingOrError">
                        <div class="card-footer" style="background-color: var(--color-formulario-terciario);" *ngIf="ListaCreditos.length != 0">
                          <div class="float-right clearfix">
                            <div class="input-group">
                              <div class="input-group-prepend">
                                <button type="button" class="btn btnOk btn-sm dropdown-toggle" data-toggle="dropdown"
                                  aria-expanded="false">
                                  <label id="lblFiltro0"></label>
                                </button>
                                <ul class="dropdown-menu" x-placement="top-start">
                                  <li class="dropdown-item" style="cursor: pointer" (click)="FiltrarPor('Identificacion', 0)">
                                    <a>Identificación</a>
                                  </li>
                                  <li class="dropdown-item" style="cursor: pointer" (click)="FiltrarPor('Nombres', 0)">
                                    <a>Nombres</a>
                                  </li>
                                  <li class="dropdown-item" style="cursor: pointer" (click)="FiltrarPor('CodCredito', 0)">
                                    <a>Cod. Credito</a>
                                  </li>
                                </ul>
                              </div>

                              <input type="text" id="TxtFiltro0" (keyup)="FiltrarLista(0, 0)"
                                class="form-control form-control-sm" />

                              <div class="input-group-append">
                                <button type="button" class="btn btnOk btn-sm" (click)="VaciarFiltro(0)">
                                  <i class="bi bi-trash"></i>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                        <table class="table table-bordered table-responsive-md"
                            *ngIf="ListaCreditos.length != 0">
                            <thead>
                                <tr>
                                  <th style="width: 10px">#</th>
                                  <th id="ThCodCredito0">Cod. Credito</th>
                                  <th id="ThIdentificacion0">Identificacion</th>
                                  <th id="ThDescripcion0">Cliente</th>
                                  <th>Contactabilidad</th>
                                  <th>Gestor</th>
                                  <th>Cartera</th>
                                  <th>Fec. Gestion</th>
                                  <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let datos of DatosCargaMasiva; let i = index">
                                  <th>{{InicioPaginacion + i + 1}}</th>
                                  <th>{{ datos.ope_cod_credito }}</th>
                                  <th>{{ datos.cli_identificacion }}</th>
                                  <th>{{ datos.cli_nombres }}</th>
                                  <th>{{ datos.ope_estado_contacta }}</th>
                                  <th>{{ datos.ges_nombres+' '+datos.ges_apellidos }}</th>
                                  <th>{{ datos.cart_descripcion }}</th>
                                  <th>{{datos.gest_fecha_gestion==null?null:fechas.fechaCortaAbt(datos.gest_fecha_gestion)}}</th>
                                  <th>
                                    <div class="btn-group" role="group">
                                        <button class="btnVer">
                                          <i class="fa-regular fa-eye"></i></button>
                                        <!-- <button *ngIf="LecturaEscritura != 0" class="ml-2 btnEditar"
                                            >
                                            <i class="fa-solid fa-sack-dollar"></i></button> -->
                                    </div>
                                  </th>
                                </tr>
                            </tbody>
                        </table>

                    </div>

                    <div class="card-footer" style="background-color: var(--color-formulario-terciario)"
                    *ngIf="ListaCreditos.length != 0">
                    <div class="row">
                      <div class="col-lg-2 col-6">
                        <p>
                          Total<strong>&nbsp;{{ ContadorDatosGeneral }}</strong>
                        </p>
                      </div>
                      <div class="col-lg-2 col-6">
                        <div *ngIf="ContadorDatosGeneral != ContadorDatos">
                          <p>
                            Resultado Filtro<strong>&nbsp;{{ ContadorDatos }}</strong>
                          </p>
                        </div>
                      </div>
                      <div class="col-lg-2 col-6">
                        <div>
                          <p>
                            Elementos<strong>&nbsp;{{ InicioPaginacion + 1 }}</strong>-<strong>&nbsp;{{ InicioPaginacion +
                              RangoPaginacion }}</strong>
                          </p>
                        </div>
                      </div>
                      <div class="col-lg-2 col-6">
                        <!-- <p>Grupo<strong>&nbsp;1</strong>-<strong>&nbsp;10</strong></p> -->
                      </div>
                      <div class="col-lg-4 col-12">
                        <div class="form-group">
                          <div class="float-right">
                            <small>
                              <button (click)="
                                  InicioPaginacion == 0
                                    ? BtnPrevious(0, 1)
                                    : BtnPrevious(0)
                                " *ngIf="FraccionDatos !== 0 || InicioPaginacion !== 0" type="button" class="BtnNextPrevious"
                                aria-label="" style="display: inline-block">
                                <i class="bi bi-arrow-left-circle"></i> Anterior
                              </button>

                              <button *ngIf="
                                  InicioPaginacion + RangoPaginacion <
                                    ContadorDatos || ContadorDatos == RangoDatos
                                " (click)="
                                  InicioPaginacion + RangoPaginacion == ContadorDatos
                                    ? BtnNext(0, 1)
                                    : BtnNext(0)
                                " type="button" class="BtnNextPrevious ml-2" aria-label="" style="display: inline-block">
                                Siguiente <i class="bi bi-arrow-right-circle"></i>
                              </button>
                            </small>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
            </div>
        </div>
      </section>


      <router-outlet></router-outlet>
  </div>
</div>
<app-footer></app-footer>

<ng-template #loadingOrError>
  <section>
    <div class="ContenidoCentrado">
      <div class="loader"></div>
    </div>
  </section>
</ng-template>

